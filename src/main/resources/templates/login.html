<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" th:with="title='YiMo后台管理登录'">
<header th:replace="header::headerFragment(${title})"></header>
<body class="gray-bg">
    <div class="middle-box text-center loginscreen  animated fadeInDown">
        <div>
            <div>

                <h1 class="logo-name">YiMo</h1>

            </div>
            <h3>欢迎使用 YiMo</h3>

            <form class="m-t" role="form" method="post" id="loginForm" >
                <div class="form-group">
                    <input type="text" maxlength="10"  id="username" name="username" class="form-control" placeholder="用户名"  value="tayle">
                </div>
                <div class="form-group">
                    <input type="password"  id="password" name="password" class="form-control" placeholder="密码" value="123456" >
                </div>
                <button type="submit" class="btn btn-primary block full-width m-b">登 录</button>
                <p class="text-muted text-center"> 
                </p>
            </form>
        </div>
    </div>
    <div th:replace="footer :: footer"></div>
    <script type="text/javascript">
    $(document).ready(function () {
        $("#login").on('click',function(){$("#loginForm").submit();});
        validateRule();
        $("body").keydown(keyDownLogon);
    });

    $.validator.setDefaults({
        submitHandler: function () {
            login();
        }
    });

    function login() {
        $.ajax({
            type: "POST",
            url: ctx+"login",
            data: $('#loginForm').serialize(),
            success: function (r) {
                 if (r.success == true) {
                    var index = layer.load(1, {
                        shade: [0.1,'#fff'] //0.1透明度的白色背景
                    });
                    parent.location.href = ctx+'index';
                } else {
                    layer.msg(r.msg);
                }
            },
        });
    }

    function keyDownLogon(){
        if (event.keyCode == "13") {
            $("#login").trigger('click');
        }
    }

    function validateRule() {
        var icon = "<i class='fa fa-times-circle'></i> ";
        $("#loginForm").validate({
            rules: {
                username: {
                    required: true
                },
                password: {
                    required: true
                }
            },
            messages: {
                username: {
                    required: icon + "请输入您的用户名",
                },
                password: {
                    required: icon + "请输入您的密码",
                }
            }
        })
    }
</script>
</body>
</html>
